# 马自达车型实验模式支持文档

本文档介绍如何在马自达车型上启用和使用实验模式（Experimental Mode）。

## 概述

Openpilot的实验模式为马自达车型提供了更多高级功能，主要包括：

1. 纵向控制（速度控制）
2. 停走功能（Stop & Go）
3. 自适应巡航控制

## 实现原理

通过修改以下关键文件，我们为马自达车型添加了实验模式支持：

1. `interface.py` - 设置车辆参数支持实验模式
2. `carcontroller.py` - 实现速度控制逻辑
3. `selfdrived.py` - 确保不会移除马自达车型的实验模式参数

实验模式通过发送虚拟按钮命令（SET+、SET-、RESUME）来控制车辆速度，与基于CAN的直接控制不同。

## 使用方法

### 开启实验模式

1. 在openpilot界面中进入设置
2. 开启"实验模式"选项
3. 重启openpilot

### CSLC功能

CSLC（Custom Speed Limit Control）是马自达车型的特殊速度控制功能：

1. 开启实验模式会自动启用CSLC
2. CSLC可以独立于实验模式使用
3. 实验模式优先级高于CSLC

### 注意事项

1. 确保理解并遵循所有安全警告
2. 实验模式下仍需全程监督驾驶
3. 速度控制可能不如原厂平滑，属于实验性功能
4. 不同车型和年款可能表现不同

## 调试信息

如果实验模式不能正常工作，可以检查以下方面：

1. 检查参数文件: `cat /data/params/d/ExperimentalMode`
2. 检查CSLC状态: `cat /data/params/d/CSLCEnabled`
3. 检查日志: `journalctl -u selfdrive`

## 已知问题

1. 在某些情况下可能需要多次尝试开启实验模式
2. 速度控制精度可能不如原厂系统
3. 部分车型可能无法完全支持所有功能

## 贡献者

感谢所有为马自达车型添加实验模式支持的开发者！