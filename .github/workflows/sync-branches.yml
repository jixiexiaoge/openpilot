name: Sync Branch

on:
  schedule:
    - cron: '0 10 * * *'  # 每天 UTC 10 点运行
  workflow_dispatch:  # 允许手动触发

jobs:
  sync:
    runs-on: ubuntu-latest

    steps:
      # 1. Checkout the target repository (your repo)
      - name: Checkout the target repository (your repo)
        uses: actions/checkout@v3
        with:
          fetch-depth: 0  # 完整克隆仓库
          token: ${{ secrets.GH_TOKEN }}

      # 2. Add upstream repositories and fetch branches
      - name: Add upstream repositories and fetch branches
        run: |
          # ajouatom carrot2-v9
          git remote add ajouatom https://github.com/ajouatom/openpilot.git
          git fetch ajouatom carrot2-v9 --no-tags
          
          # sunnypilot dev-c3-new
          git remote add sunnypilot https://github.com/sunnypilot/sunnypilot.git
          git fetch sunnypilot dev-c3-new --no-tags
          
          # dragonpilot pre-build
          git remote add dragonpilot https://github.com/dragonpilot-community/dragonpilot.git
          git fetch dragonpilot pre-build --no-tags
          
          # FrogPilot FrogPilot
          git remote add frogpilot https://github.com/FrogAi/FrogPilot.git
          git fetch frogpilot FrogPilot --no-tags

      # 3. Push branches to your repository
      - name: Push branches to your repository
        run: |
          # carrot2-v9
          git checkout -B carrot2-v9 ajouatom/carrot2-v9
          git push origin carrot2-v9 --force

          # sunnypilot dev-c3-new
          git checkout -B dev-c3-new sunnypilot/dev-c3-new
          git push origin dev-c3-new --force

          # dragonpilot pre-build
          git checkout -B dragonpilot-pre-build dragonpilot/pre-build
          git push origin dragonpilot-pre-build --force

          # frogpilot FrogPilot
          git checkout -B frogpilot frogpilot/FrogPilot
          git push origin frogpilot --force
